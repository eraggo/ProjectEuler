Nothing hard to do, but had brain fart on my main function for a while.

I think code is easier to read (and DEBUG) when it is propally organized in smaller pieces.
